<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Verify Email</title>

    <!-- Font Icon -->
    <link
      rel="stylesheet"
      href="fonts/material-icon/css/material-design-iconic-font.min.css"
    />

    <!-- Main css -->
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <%- include('../partials/header') %>

      <main class="verify-email-page container main-container">
      <h1 class="section-title text-center">Verify Your Email</h1>
      <div class="alert-container">
        <% // Use `success` and `errors` if provided by res.locals; otherwise fall back to empty arrays %>
        <% const successMessages = (typeof success !== 'undefined' && success) ? success : []; %>
        <% const errorMessages = (typeof errors !== 'undefined' && errors) ? errors : []; %>

        <% if (successMessages && successMessages.length > 0) { %>
          <% successMessages.forEach(function(msg){ %>
            <div class="alert alert-success">
              <i class="zmdi zmdi-check-circle"></i>
              <span><%= msg %></span>
            </div>
          <% }) %>
        <% } %>

        <% if (errorMessages && errorMessages.length > 0) { %>
          <% errorMessages.forEach(function(msg){ %>
            <div class="alert alert-danger">
              <i class="zmdi zmdi-alert-circle"></i>
              <span><%= msg %></span>
            </div>
          <% }) %>
        <% } %>
      </div>

      <div class="card">
        <div class="card-body">
          <p class="info-text"><strong>Email:</strong> <%= email %></p>
          <p class="info-text">
            Your email has not been verified yet. Please verify your email by
            entering the 8-digit code or request a new verification link.
          </p>

          <form
            action="/resend-verification-link"
            method="post"
            class="form-inline"
          >
              <button type="submit" class="btn btn-secondary verify-resend-btn">
                Resend Verification Link
              </button>
          </form>
        </div>
      </div>

      <div class="card mt-20">
        <div class="card-body">
          <form action="/verify-email-token" method="get" class="form">
            <div class="form-group">
              <label for="token" class="control-label"
                >Enter 8-Digit Verification Code:</label
              >
                <input
                  type="text"
                  name="token"
                  id="token"
                  class="form-control otp-input"
                  inputmode="numeric"
                  maxlength="8"
                  required
                  pattern="\d{8}"
                  title="Please enter an 8-digit number"
                />
            </div>

            <input type="hidden" value="<%= email %>" name="email" />

              <button type="submit" class="btn btn-primary verify-submit-btn">Verify Code</button>
          </form>
        </div>
      </div>
    </main>
    <%- include('../partials/footer.ejs') %>
    <!-- JS -->
  </body>
</html>